<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨ä½“ãƒ©ãƒ³ã‚­ãƒ³ã‚° - ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <header>
        <div class="container">
            <h1><a href="/" class="home-link">ğŸ® ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </a></h1>
        </div>
    </header>

    <main class="container">
        <div class="leaderboard-container">
            <h2>ğŸ† å…¨ä½“ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
            
            <div class="ranking-tabs" style="display: flex; gap: 10px; margin-bottom: 20px; justify-content: center;">
                <button class="btn btn-primary" onclick="showRanking('best-score')" id="tab-best-score">æœ€é«˜ã‚¹ã‚³ã‚¢</button>
                <button class="btn btn-secondary" onclick="showRanking('total-score')" id="tab-total-score">åˆè¨ˆã‚¹ã‚³ã‚¢</button>
                <button class="btn btn-secondary" onclick="showRanking('games-played')" id="tab-games-played">ãƒ—ãƒ¬ã‚¤å›æ•°</button>
            </div>
            
            <div id="ranking-content">
                <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>
        </div>
    </main>

    <script>
        function showRanking(type) {
            // Update tab buttons
            document.querySelectorAll('.ranking-tabs button').forEach(btn => {
                btn.className = 'btn btn-secondary';
            });
            document.getElementById(`tab-${type}`).className = 'btn btn-primary';
            
            // Show loading
            document.getElementById('ranking-content').innerHTML = '<div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>';
            
            // Fetch ranking data
            const endpoint = `/api/players/ranking/${type}`;
            fetch(endpoint)
                .then(response => response.json())
                .then(players => {
                    const content = document.getElementById('ranking-content');
                    if (players.length === 0) {
                        content.innerHTML = '<div class="no-data">ã¾ã ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                        return;
                    }
                    
                    let title = '';
                    let valueKey = '';
                    switch(type) {
                        case 'best-score':
                            title = 'æœ€é«˜ã‚¹ã‚³ã‚¢';
                            valueKey = 'bestScore';
                            break;
                        case 'total-score':
                            title = 'åˆè¨ˆã‚¹ã‚³ã‚¢';
                            valueKey = 'totalScore';
                            break;
                        case 'games-played':
                            title = 'ãƒ—ãƒ¬ã‚¤å›æ•°';
                            valueKey = 'totalGamesPlayed';
                            break;
                    }
                    
                    content.innerHTML = `
                        <h3 style="text-align: center; color: #667eea; margin-bottom: 20px;">${title}ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
                        <table class="leaderboard-table">
                            <thead>
                                <tr>
                                    <th>é †ä½</th>
                                    <th>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å</th>
                                    <th>${title}</th>
                                    <th>ç·ãƒ—ãƒ¬ã‚¤å›æ•°</th>
                                    <th>åˆè¨ˆã‚¹ã‚³ã‚¢</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${players.map((player, index) => `
                                    <tr>
                                        <td>${index + 1}</td>
                                        <td><strong>${player.name || 'ä¸æ˜'}</strong></td>
                                        <td>${player[valueKey] || 0}</td>
                                        <td>${player.totalGamesPlayed || 0}</td>
                                        <td>${player.totalScore || 0}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `;
                })
                .catch(error => {
                    console.error('Error loading ranking:', error);
                    document.getElementById('ranking-content').innerHTML = 
                        '<div class="error">ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</div>';
                });
        }
        
        // Load default ranking on page load
        window.addEventListener('DOMContentLoaded', () => {
            showRanking('best-score');
        });
    </script>
</body>
</html>

